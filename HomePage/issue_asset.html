<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assets</title>
  </head>
  <body>
    <form class="upload">
      <input type="file" name="uploadFile" required />
      <br /><br />
      <input type="submit" />
    </form>
    <script>
      const JWT =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiIzYTEwNDFlNi1lYzc4LTQ2YzYtYjQzMC02N2I2NDM2Mjg1ZmEiLCJlbWFpbCI6Imdob3NodmlkaXAyNkBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicGluX3BvbGljeSI6eyJyZWdpb25zIjpbeyJpZCI6IkZSQTEiLCJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MX0seyJpZCI6Ik5ZQzEiLCJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MX1dLCJ2ZXJzaW9uIjoxfSwibWZhX2VuYWJsZWQiOmZhbHNlLCJzdGF0dXMiOiJBQ1RJVkUifSwiYXV0aGVudGljYXRpb25UeXBlIjoic2NvcGVkS2V5Iiwic2NvcGVkS2V5S2V5IjoiYThmZjBiNzk2OWE2ZDU3Njk1NmMiLCJzY29wZWRLZXlTZWNyZXQiOiIwNjVmNTMzYzUyNmI4YzhjMDFiY2U2MzY1MjA5ZTE2NjBkYjQxZjdkY2M1MjYwYzgwN2Y5OTY1Mzc5YTllZjYwIiwiaWF0IjoxNzIyOTQ5MjAxfQ.-c_DMpGWC_Z4dHCLQWG-cFIW5hEyHaceM3RIoBo8b0c";

      async function pinFileToIPFS(e) {
        e.preventDefault();

        try {
          const uploadFile = document.querySelector('input[type="file"]');

          if (!uploadFile.files.length) {
            console.error("No file selected.");
            return;
          }

          const file = uploadFile.files[0];
          const formData = new FormData();
          formData.append("file", file);

          const response = await fetch(
            "https://api.pinata.cloud/pinning/pinFileToIPFS",
            {
              method: "POST",
              headers: {
                Authorization: `Bearer ${JWT}`,
              },
              body: formData,
            }
          );

          if (!response.ok) {
            throw new Error(`Error: ${response.statusText}`);
          }

          const result = await response.json();
          console.log("File uploaded successfully:", result);
        } catch (err) {
          console.error("Upload failed:", err);
        }
      }

      document
        .querySelector(".upload")
        .addEventListener("submit", pinFileToIPFS);
    </script>
  </body>
</html>
